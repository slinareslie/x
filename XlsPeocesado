https://1drv.ms/f/c/382bae9df2c5aacc/En_05KHmpBRCgcxUFAyw92YBt8j0H0G6-43HRwkdpr3dtw?e=eQWckX

Private Sub TextBox1_Change()
    Dim filtro As String
    Dim columna As Integer
    Dim rg As Range
    Dim ws As Worksheet
    
    Set ws = Worksheets("Registros")
    Set rg = ws.Range("A6").CurrentRegion

    ' Quitar cualquier filtro anterior antes de aplicar uno nuevo
    On Error Resume Next
    If ws.FilterMode Then ws.ShowAllData
    On Error GoTo 0

    ' Obtener columna según ComboBox
    Select Case Me.ComboBox1.Value
        Case "Num Expediente": columna = 2
        Case "Tipo de Documento": columna = 3
        Case "N° Documento Acumulador": columna = 4
        Case "Nombre": columna = 7
        Case "COD/RUC": columna = 8
        Case Else: columna = 1
    End Select

    filtro = "*" & Me.TextBox1.Text & "*"

    If Me.TextBox1.Text <> "" Then
        rg.AutoFilter Field:=columna, Criteria1:=filtro
    Else
        ' Si el textbox está vacío, quitar filtros
        On Error Resume Next
        If ws.FilterMode Then ws.ShowAllData
        On Error GoTo 0
    End If
End Sub
