Private Sub TextBox1_Change()
    Dim criterio As String
    Dim columna As Integer
    Dim celda As Range
    Dim rngDatos As Range
    Dim textoCelda As String
    Dim textoFiltro As String
    Dim ultimaFila As Long
    Dim i As Long

    Application.ScreenUpdating = False
    Application.EnableEvents = False

    ' Determinar columna según ComboBox
    Select Case Me.ComboBox1.Value
        Case "Num Correlativo": columna = 1
        Case "Num Expediente": columna = 2
        Case "Tipo de Documento": columna = 3
        Case "N° Documento Acumulador": columna = 4
        Case "Nombre": columna = 5
        Case "COD/RUC": columna = 6
        Case Else: columna = 1
    End Select

    ' Normalizar texto ingresado
    criterio = NormalizarTexto(Me.TextBox1.Text)

    ' Obtener última fila con datos en esa columna
    ultimaFila = Me.Cells(Me.Rows.Count, columna).End(xlUp).Row

    ' Mostrar todo si no hay texto
    If criterio = "" Then
        Me.Rows.Hidden = False
        GoTo Salir
    End If

    ' Recorremos solo desde la fila 7 (asumiendo encabezado en 6)
    For i = 7 To ultimaFila
        textoCelda = NormalizarTexto(Me.Cells(i, columna).Text)
        If InStr(1, textoCelda, criterio, vbTextCompare) = 0 Then
            Me.Rows(i).Hidden = True
        Else
            Me.Rows(i).Hidden = False
        End If
    Next i

Salir:
    Application.EnableEvents = True
    Application.ScreenUpdating = True
End Sub
