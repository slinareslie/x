SortByColumns(
    AddColumns(
        GroupBy(
            Filter(
                [@'DirectorioTransportistaSIGAD'],
                Dropdown1_1.Selected.Value = "Nombre" &&
                (
                    StartsWith(EMPTRANSPINTER, TextSearchBox1_2.Text) ||
                    EndsWith(EMPTRANSPINTER, TextSearchBox1_2.Text)
                )
            ),
            "CODIGO",               // Campo de agrupaci√≥n
            "GroupTransportistas"   // Nombre del grupo
        ),
        "FirstEmpresa", First(GroupTransportistas),
        "NombreEmpresa", First(GroupTransportistas).EMPTRANSPINTER  // Campo plano para ordenamiento
    ),
    "NombreEmpresa",  // Ahora se puede ordenar por este campo
    If(
        SortDescending1_1,
        SortOrder.Descending,
        SortOrder.Ascending
    )
)
