Private Sub Worksheet_Activate()
    With Me.ComboBox1
        .Clear
        .AddItem "Num Correlativo"            ' Columna 1
        .AddItem "Num Expediente"             ' Columna 2
        .AddItem "Tipo de Documento"          ' Columna 3
        .AddItem "N° Documento Acumulador"    ' Columna 4
        .AddItem "Nombre"                     ' Columna 5
        .AddItem "COD/RUC"                    ' Columna 6
        .ListIndex = 0                        ' Selecciona por defecto el primero
    End With
End Sub

Private Sub TextBox1_Change()
    Dim filtro As String
    Dim columna As Integer
    Dim rg As Range

    Set rg = Me.Range("A6").CurrentRegion

    ' Quitar cualquier filtro anterior antes de aplicar uno nuevo
    On Error Resume Next
    If Me.FilterMode Then Me.ShowAllData
    On Error GoTo 0

    ' Obtener columna según ComboBox
    Select Case Me.ComboBox1.Value
        Case "Num Correlativo": columna = 1
        Case "Num Expediente": columna = 2
        Case "Tipo de Documento": columna = 3
        Case "N° Documento Acumulador": columna = 4
        Case "Nombre": columna = 5
        Case "COD/RUC": columna = 6
        Case Else: columna = 1
    End Select

    filtro = "*" & Me.TextBox1.Text & "*"

    ' Si hay texto, aplicar filtro
    If Me.TextBox1.Text <> "" Then
        rg.AutoFilter Field:=columna, Criteria1:=filtro
    End If
End Sub

Private Sub ComboBox1_Change()
    ' Quitar cualquier filtro anterior
    On Error Resume Next
    If Me.FilterMode Then Me.ShowAllData
    On Error GoTo 0

    ' Limpiar el TextBox
    Me.TextBox1.Text = ""
End Sub
