=TEXTO(FECHA(DERECHA(D2;2)+2000;EXTRAE(D2;4;2);IZQUIERDA(D2;2)) + EXTRAE(D2;10;2)/24 + EXTRAE(D2;13;2)/1440 + EXTRAE(D2;16;2)/86400; "dd/mm/aa hh:mm:ss")



Sub CorregirFechasAnglosajonas()

    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets("Parejas")

    Dim ultimaFila As Long, i As Long
    ultimaFila = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row

    Dim celdas As Range
    Set celdas = ws.Range("B2:C" & ultimaFila) ' Entradas y salidas

    Dim celda As Range
    For Each celda In celdas
        If IsDate(celda.Value) Then
            Dim valorFecha As Date: valorFecha = celda.Value
            Dim d As Integer: d = Day(valorFecha)
            Dim m As Integer: m = Month(valorFecha)

            ' Si el día está entre 1 y 12 y el mes también, puede estar invertido
            If d <= 12 And m <= 12 And m <> d Then
                ' Probable formato mal interpretado -> lo volvemos texto en orden latino
                celda.Value = Format(valorFecha, "dd/mm/yyyy hh:mm:ss")
                celda.NumberFormat = "@"
            End If
        End If
    Next celda

    MsgBox "Fechas corregidas en formato latino (dd/mm/yyyy hh:mm:ss)."

End Sub
