# Desactivar alertas
$excel.DisplayAlerts = $false

# Crear hoja temporal
$tempSheet = $workbook.Sheets.Add()
$tempSheet.Name = "Temporal"

# Copiar estadísticas
$sheetStats.UsedRange.Copy()
$tempSheet.Range("A1").PasteSpecial(-4104)

# Limpiar portapapeles
[System.Windows.Forms.Clipboard]::Clear()

# Fila de inicio
$rowStart = $sheetStats.UsedRange.Rows.Count + 2
$lastRow = $sheetDatos.UsedRange.Rows.Count

# Copiar columnas específicas desde hoja "Datos"
$sheetDatos.Range("F2:F$lastRow").Copy()
$tempSheet.Range("A$rowStart").PasteSpecial(-4104)
$sheetDatos.Range("H2:H$lastRow").Copy()
$tempSheet.Range("B$rowStart").PasteSpecial(-4104)
$sheetDatos.Range("I2:I$lastRow").Copy()
$tempSheet.Range("C$rowStart").PasteSpecial(-4104)
$sheetDatos.Range("J2:J$lastRow").Copy()
$tempSheet.Range("D$rowStart").PasteSpecial(-4104)
$sheetDatos.Range("L2:L$lastRow").Copy()
$tempSheet.Range("E$rowStart").PasteSpecial(-4104)

# Limpiar portapapeles y desactivar selección
$excel.CutCopyMode = $false

# Ajustar columnas
$tempSheet.Columns("A").ColumnWidth = 16.5
$tempSheet.Columns("B").ColumnWidth = 20
$tempSheet.Columns("C").ColumnWidth = 20
$tempSheet.Columns("D").AutoFit()
$tempSheet.Columns("E").ColumnWidth = 13

# Exportar a PDF
$tempSheet.ExportAsFixedFormat(0, $outputPDF)

# Activar otra hoja antes de borrar
$workbook.Sheets.Item(1).Activate()

# Borrar hoja temporal
$tempSheet.Delete()

# Guardar libro
$workbook.Save()
