@echo off
REM Verificar si SQL Developer est치 abierto antes de continuar
tasklist /FI "IMAGENAME eq sqldeveloper.exe" 2>NUL | find /I /N "sqldeveloper.exe">NUL
if "%ERRORLEVEL%"=="0" (
    echo ============================================
    echo SQL Developer est치 abierto.
    echo Por favor, cierre SQL Developer antes de continuar con la extracci칩n.
    echo ============================================
    pause
    exit /b
)

REM Definir la fecha en formato dd-mm-yyyy
for /f "tokens=2 delims==" %%I in ('"wmic OS Get localdatetime /value"') do set datetime=%%I
set fecha=%datetime:~6,2%-%datetime:~4,2%-%datetime:~0,4%

REM Definir la ruta de destino para el archivo CSV
set carpeta=D:\SEBASTIAN\Taermi Final\csv\

REM Asegurarse de que la ruta termine con una barra invertida (\)
if not "%carpeta:~-1%" == "\" set carpeta=%carpeta%\

REM Definir el nombre del archivo CSV de salida
set archivo=%carpeta%MCI-TAERMI-%fecha%.csv
set archivo1=MCI-TAERMI-%fecha%.csv

REM Ejecutar la consulta y exportarla a un archivo CSV
REM sqlplus -S usuario/BD.@sadda @TAERMI-AUT.sql

echo Extracci칩n completada exitosamente.
pause
