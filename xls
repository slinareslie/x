$outputExcel = "$inputFolder\" + [System.IO.Path]::GetFileNameWithoutExtension($inputXls) + ".xlsx"


$workbook.SaveAs($outputExcel, 51)  # 51 = formato XLSX


# Obtener el nombre base del archivo original
$outputExcel = "$inputFolder\" + [System.IO.Path]::GetFileNameWithoutExtension($inputXls) + ".xlsx"

# Guardar el archivo con el mismo nombre, pero en formato XLSX
$workbook.SaveAs($outputExcel, 51)

# Cerrar el libro y la aplicaci√≥n de Excel
$workbook.Close($false)
$excel.Quit()

# Liberar memoria de los objetos COM
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($workbook) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($worksheet) | Out-Null
[System.Runtime.Interopservices.Marshal]::ReleaseComObject($worksheetStats) | Out-Null

Write-Host "Proceso completado. Archivo Excel guardado en: $outputExcel"
